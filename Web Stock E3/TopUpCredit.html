<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topup - PLAYERHAVEN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á (‡πÄ‡∏û‡∏ä‡∏£‡∏ü‡πâ‡∏≤‡∏Ç‡∏≤‡∏ß‡∏£‡∏∞‡∏¢‡∏¥‡∏ö) */
        body {
            position: relative;
            background: linear-gradient(45deg, #e6f3ff, #b3d4ff, #e6f3ff);
            transition: background 0.5s ease, background-color 0.5s ease;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,%3Csvg width="100" height="100" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="50" cy="50" r="2" fill="rgba(100, 200, 255, 0.8)" /%3E%3C/svg%3E') repeat;
            animation: sparkleLight 3s infinite;
            pointer-events: none;
            z-index: -1;
        }

        /* ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î (‡πÄ‡∏û‡∏ä‡∏£‡∏ü‡πâ‡∏≤‡∏î‡∏≥‡∏Ñ‡∏£‡∏∂‡πâ‡∏°‡∏£‡∏∞‡∏¢‡∏¥‡∏ö) */
        body.dark-mode {
            background: linear-gradient(45deg, #0a1a2f, #1a3b5d, #0a1a2f);
        }

        body.dark-mode::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,%3Csvg width="100" height="100" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="50" cy="50" r="1" fill="rgba(0, 100, 200, 0.7)" /%3E%3C/svg%3E') repeat;
            animation: sparkleDark 3s infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes sparkleLight {
            0% { opacity: 0.3; }
            50% { opacity: 0.8; }
            100% { opacity: 0.3; }
        }

        @keyframes sparkleDark {
            0% { opacity: 0.2; }
            50% { opacity: 0.7; }
            100% { opacity: 0.2; }
        }

        /* Theme mode */
        .dark-mode {
            background-color: #0a1a2f;
            color: white;
        }

        .dark-mode header {
            background-color: #1a3b5d;
        }

        .dark-mode .bg-indigo-600 {
            background-color: #1a3b5d !important;
        }

        /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° */
        .dark-mode .bg-blue-600 {
            background-color: #2563eb !important;
            color: white !important;
        }

        .dark-mode .bg-red-600 {
            background-color: #dc2626 !important;
            color: white !important;
        }

        .dark-mode .bg-green-500 {
            background-color: #22c55e !important;
            color: white !important;
        }

        .dark-mode .bg-red-500 {
            background-color: #ef4444 !important;
            color: white !important;
        }

        /* Switch Toggle Button */
        .theme-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: background-color 0.4s ease;
            border-radius: 34px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 30px;
            width: 30px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: transform 0.4s ease;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .slider:after {
            content: " ";
            font-size: 18px;
            color: #f1c40f;
            transition: opacity 0.3s ease, content 0.3s ease;
        }

        input:checked+.slider {
            background-color: #2c3e50;
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        input:checked+.slider:after {
            content: "üåô";
            color: #fff;
        }

        .bg-nav {
            background-color: #1a1f36;
        }

        /* Red Envelope Styles */
        .red-envelope {
            background-color: #ff4444;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .red-envelope:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .dark-mode .red-envelope {
            background-color: #dc2626;
        }
    </style>
</head>

<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-nav text-white">
        <!-- Navbar -->
        <div class="container mx-auto flex items-center justify-between py-0 px-4">
            <div class="text-2xl font-bold inline">
                <img id="logo" src="image/logo_player/light_logo.png" alt="light_logo"
                    class="w-auto h-24 inline mr-3 transform transition-transform duration-300 hover:scale-105 filter brightness-90" />
                PLAYERHAVEN
            </div>
            <nav class="flex space-x-4">
                <a href="HomePage.php" class="hover:text-indigo-300">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
                <a href="HomePage.php" onclick="scrollToBottom()" class="hover:text-indigo-300">‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏≠‡∏î‡∏µ‡πÄ‡∏Å‡∏°</a>
                <a href="RandomWheel.php" class="hover:text-indigo-300">‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏≠‡∏î‡∏µ‡πÄ‡∏Å‡∏°</a>
                <a href="TopUpCredit.html" class="hover:text-indigo-300">‡πÄ‡∏ï‡∏¥‡∏° Points</a>
                <a href="ProfileEdit.html" class="hover:text-indigo-300">‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a>
                <a href="contact.html" class="hover:text-indigo-300">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
            </nav>
            <div class="space-x-4">
                <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö -->
                <button id="loginBtn" class="bg-indigo-700 px-4 py-2 rounded hover:bg-indigo-800"
                    onclick="location.href='Login.html'">
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>

                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <button id="registerBtn" class="border border-white px-4 py-2 rounded hover:bg-indigo-700"
                    onclick="location.href='Register.html'">
                    ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>

                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö (‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô) -->
                <button id="logoutBtn" class="hidden bg-red-500 px-4 py-2 rounded hover:bg-red-600" onclick="logout()">
                    ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                </button>

                <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°‡πÅ‡∏ö‡∏ö‡∏™‡πÑ‡∏•‡∏î‡πå‡∏ó‡πá‡∏≠‡∏Å‡πÄ‡∏Å‡∏¥‡∏• -->
                <label class="theme-toggle">
                    <input type="checkbox" id="themeToggle" onchange="toggleTheme()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </header>

    <!-- Main Section -->
    <div class="container mx-auto py-8">
        <h1 class="text-3xl font-bold text-center mb-6 bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-blue-600 decoration-4 underline underline-offset-8 decoration-blue-400">
            ‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á
        </h1>
        
        <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -->
        <div class="text-center mb-6">
            <p class="text-xl font-semibold text-gray-700 dark:text-gray-300">‡∏¢‡∏≠‡∏î‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="currentPoints">0</span> ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</p>
        </div>

        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏á‡πÄ‡∏õ‡∏≤ -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- ‡∏≠‡∏±‡∏á‡πÄ‡∏õ‡∏≤ 100 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï (50 ‡∏ö‡∏≤‡∏ó) -->
            <div class="red-envelope text-white text-center cursor-pointer" onclick="selectRedEnvelope(100, 50)">
                <h2 class="text-xl font-bold">‡πÄ‡∏ï‡∏¥‡∏° 100 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</h2>
                <p class="text-lg">‡∏£‡∏≤‡∏Ñ‡∏≤: 50 ‡∏ö‡∏≤‡∏ó</p>
            </div>

            <!-- ‡∏≠‡∏±‡∏á‡πÄ‡∏õ‡∏≤ 500 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï (200 ‡∏ö‡∏≤‡∏ó) -->
            <div class="red-envelope text-white text-center cursor-pointer" onclick="selectRedEnvelope(500, 200)">
                <h2 class="text-xl font-bold">‡πÄ‡∏ï‡∏¥‡∏° 500 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</h2>
                <p class="text-lg">‡∏£‡∏≤‡∏Ñ‡∏≤: 200 ‡∏ö‡∏≤‡∏ó</p>
            </div>

            <!-- ‡∏≠‡∏±‡∏á‡πÄ‡∏õ‡∏≤ 1,000 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï (400 ‡∏ö‡∏≤‡∏ó) -->
            <div class="red-envelope text-white text-center cursor-pointer" onclick="selectRedEnvelope(1000, 400)">
                <h2 class="text-xl font-bold">‡πÄ‡∏ï‡∏¥‡∏° 1,000 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</h2>
                <p class="text-lg">‡∏£‡∏≤‡∏Ñ‡∏≤: 400 ‡∏ö‡∏≤‡∏ó</p>
            </div>
        </div>

        <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
        <div id="paymentForm" class="mt-8 hidden bg-white p-6 rounded-lg shadow-md dark:bg-gray-800">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-white">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</h2>
            <p class="mb-4 text-gray-700 dark:text-gray-300">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: <span id="selectedEnvelope"></span></p>
            <div class="mb-4">
                <label class="block text-gray-700 dark:text-gray-300">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                <select id="paymentMethod" class="w-full p-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white">
                    <option value="creditCard">‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï/‡πÄ‡∏î‡∏ö‡∏¥‡∏ï</option>
                    <option value="paypal">PayPal</option>
                </select>
            </div>
            <div id="creditCardFields" class="mb-4 hidden">
                <label class="block text-gray-700 dark:text-gray-300">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£</label>
                <input type="text" id="cardNumber" class="w-full p-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white" placeholder="1234 5678 9012 3456">
                <label class="block mt-2 text-gray-700 dark:text-gray-300">‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (MM/YY)</label>
                <input type="text" id="expiryDate" class="w-full p-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white" placeholder="MM/YY">
                <label class="block mt-2 text-gray-700 dark:text-gray-300">CVV</label>
                <input type="text" id="cvv" class="w-full p-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white" placeholder="123">
            </div>
            <div id="paypalFields" class="mb-4 hidden">
                <label class="block text-gray-700 dark:text-gray-300">‡∏≠‡∏µ‡πÄ‡∏°‡∏• PayPal</label>
                <input type="email" id="paypalEmail" class="w-full p-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white" placeholder="example@paypal.com">
            </div>
            <button id="submitPayment" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded mt-4">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
            <button id="cancelPayment" class="w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded mt-2">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
    </div>

    <!-- Script -->
    <script>
        function scrollToBottom() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth' 
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°
        function toggleTheme() {
            const body = document.body;
            const navbar = document.querySelector("header");
            const logo = document.getElementById("logo");
            const isDarkMode = body.classList.toggle("dark-mode");

            if (isDarkMode) {
                logo.src = "image/logo_player/dark_logo.png"; // ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°
                body.style.backgroundColor = "#10142b";
                navbar.style.backgroundColor = "#1a1f36";
            } else {
                logo.src = "image/logo_player/light_logo.png"; // ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥/‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á
                body.style.backgroundColor = "#10142b";
                navbar.style.backgroundColor = "#1a1f36";
            }

            localStorage.setItem("theme", isDarkMode ? "dark" : "light");
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ò‡∏µ‡∏°‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.onload = function () {
            const savedTheme = localStorage.getItem("theme");
            if (savedTheme === "dark") {
                document.body.classList.add("dark-mode");
                document.getElementById("logo").src = "image/logo_player/dark_logo.png";
                document.body.style.backgroundColor = "#10142b";
                document.querySelector("header").style.backgroundColor = "#1a1f36";
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°
            const username = localStorage.getItem("username");
            const loginBtn = document.getElementById("loginBtn");
            const registerBtn = document.getElementById("registerBtn");
            const logoutBtn = document.getElementById("logoutBtn");

            if (username) {
                logoutBtn.classList.remove("hidden");
                loginBtn.classList.add("hidden");
                registerBtn.classList.add("hidden");
                fetchCurrentPoints();
            } else {
                logoutBtn.classList.add("hidden");
                loginBtn.classList.remove("hidden");
                registerBtn.classList.remove("hidden");
                window.location.href = "Login.html";
            }
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Logout
        function logout() {
            localStorage.removeItem("username");
            localStorage.removeItem("email");
            window.location.href = "Login.html";
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏á‡πÄ‡∏õ‡∏≤
        function selectRedEnvelope(points, price) {
            const paymentForm = document.getElementById("paymentForm");
            const selectedEnvelope = document.getElementById("selectedEnvelope");
            selectedEnvelope.textContent = `${points} ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï (‡∏£‡∏≤‡∏Ñ‡∏≤ ${price} ‡∏ö‡∏≤‡∏ó)`;
            paymentForm.classList.remove("hidden");

            // ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const paymentMethod = document.getElementById("paymentMethod");
            const creditCardFields = document.getElementById("creditCardFields");
            const paypalFields = document.getElementById("paypalFields");

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            if (paymentMethod.value === "creditCard") {
                creditCardFields.classList.remove("hidden");
                paypalFields.classList.add("hidden");
            } else {
                creditCardFields.classList.add("hidden");
                paypalFields.classList.remove("hidden");
            }

            paymentMethod.addEventListener("change", function () {
                if (paymentMethod.value === "creditCard") {
                    creditCardFields.classList.remove("hidden");
                    paypalFields.classList.add("hidden");
                } else {
                    creditCardFields.classList.add("hidden");
                    paypalFields.classList.remove("hidden");
                }
            });

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
            document.getElementById("submitPayment").onclick = function () {
                const method = paymentMethod.value;
                let isValid = false;

                if (method === "creditCard") {
                    const cardNumber = document.getElementById("cardNumber").value;
                    const expiryDate = document.getElementById("expiryDate").value;
                    const cvv = document.getElementById("cvv").value;
                    isValid = cardNumber && expiryDate && cvv; // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á
                } else if (method === "paypal") {
                    const paypalEmail = document.getElementById("paypalEmail").value;
                    isValid = paypalEmail; // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á
                }

                if (isValid) {
                    processPayment(points, price, method);
                } else {
                    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
                }
            };

            // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
            document.getElementById("cancelPayment").onclick = function () {
                paymentForm.classList.add("hidden");
            };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        function fetchCurrentPoints() {
            const username = localStorage.getItem("username");
            if (username) {
                fetch("get_profile.php")
                    .then(response => response.json())
                    .then(data => {
                        if (data.logged_in) {
                            const points = data.user.point || 0;
                            document.getElementById("currentPoints").textContent = points;
                        }
                    })
                    .catch(error => console.error("Error fetching points:", error));
            }
        }

        function processPayment(points, price, method) {
            alert(`‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô ${price} ‡∏ö‡∏≤‡∏ó ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${points} ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï`);

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÉ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
            const username = localStorage.getItem("username");
            if (username) {
                fetch("update_points.php", {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: `username=${encodeURIComponent(username)}&points=${points}&payment_amount=${price}&payment_method=${encodeURIComponent(method)}`
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        fetchCurrentPoints(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                        document.getElementById("paymentForm").classList.add("hidden");
                    } else {
                        alert("‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: " + data.message);
                    }
                })
                .catch(error => console.error("Error updating points:", error));
            }
        }
    </script>
</body>
</html>